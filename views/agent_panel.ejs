<%- include("header", {title: title}); %>
<link rel="stylesheet" href="/style/agent_panel.css">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" />
<link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

    <div id="main_view">
        <nav id="navbar">
            <h1 id="navbar_title">Ticket System</h1>

            <h3>Logged in as: <%= user.displayName %></h3>
        </nav>
        
        <div id="main_container">
            <div id="sidebar">
                <div id="sidebar_navigation">
                    <button class="sidebar_button" onclick="window.location='/dashboard'"><i class="material-icons">dashboard</i>DASHBOARD</button>
                    <button class="sidebar_button" onclick="window.location='/knowledgeBoard'"><i class="material-icons">auto_stories</i>BOARD</button>
                    <button class="sidebar_button" id="sidebar_selected"><i class="material-icons">admin_panel_settings</i>AGENTS</button>
                </div>

                <button id="logout_button" onclick="window.location='/logout'">Logout <i class="fa fa-sign-out"></i></button>
            </div>

            <div id="floating_container">
                <div id="creation_container">
                    <div id="category_creation">
                        <form id="new_category" action="/dashboard/createCategory" method="post">
                            <input id="category_name" name="category_name" placeholder="Add a new category..." required maxlength="50">

                            <button id="new_category_button" type="submit">Create</button>
                        </form>
                    </div>

                    <form action="/agentPanel/createUser" method="post">
                        <div id="user_creation">
                            <label for="name">Name</label>
                            <input name="name" required maxlength="100">

                            <label for="email">Email</label>
                            <input name="email" required maxlength="100" type="email">

                            <label for="password">Password</label>
                            <input name="password" required maxlength="100" type="password">

                            <select name="role">
                                <option value="rol_n3r9Bk6sdCqkN5XN">User</option>
                                <% if (role == "Super Admin") { %>
                                    <option value="rol_O69N7QGMEMtlMDhZ">Agent</option>
                                <% } %>
                            </select>

                            <button type="submit">Create</button>
                        </div>
                    </form>
                </div>

                <div id="requests_container">
                    <div id="reopen_requests">
                        <table>
                            <colgroup>
                                <col style="width: 30%">
                                <col style="width: 70%">
                            </colgroup>
                            <thead>
                                <th>Ticket ID</th>
                                <th>Author</th>
                            </thead>
                            <tbody>
                                <% for(i = 0; i < reopen_requests.length; i++) { %>
                                    <tr onclick="window.location='/dashboard/<%= i + 1 %>'">
                                        <td><%= reopen_requests[i].ticket_id %></td>
                                        <td><%= reopen_requests[i].author_name %></td>
                                    </tr>
                                <% } %>
                            </tbody>
                        </table>
                    </div>

                    <div id="user_creation_requests">
                        <table>
                            <colgroup>
                                <col style="width: 30%">
                                <col style="width: 70%">
                            </colgroup>
                            <thead>
                                <th>User Mail</th>
                                <th>Message</th>
                            </thead>
                            <tbody>
                                <% for(i = 0; i < user_creation_requests.length; i++) { %>
                                    <tr onclick="openUserCreationMenu('<%= user_creation_requests[i].user_email %>')">
                                        <td><%= user_creation_requests[i].user_email %></td>
                                        <td><%= user_creation_requests[i].user_message %></td>
                                    </tr>
                                <% } %>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>

        <div id="my_modal" class="modal">
            <div class="modal-content">
                <span class="close">&times;</span>

                <form action="/agentPanel/acceptCreateUser" method="post" id="accept_user_creation_form">
                    <div id="modal_container">
                        <div class="spacing_container">
                            <label for="name">Name</label>
                            <input id="name" name="name" value="Temp" disabled>
                        </div>

                        <div class="spacing_container">
                            <label for="email">Email</label>
                            <input id="email" name="email" value="" disabled>
                        </div>

                        <div class="spacing_container">
                            <select name="role">
                                <option value="rol_n3r9Bk6sdCqkN5XN">User</option>
                                <% if (role == "Super Admin") { %>
                                    <option value="rol_O69N7QGMEMtlMDhZ">Agent</option>
                                <% } %>
                            </select>
                        </div>

                        <button type="submit" id="accept_button">Accept</button>

                        <button id="deny_button" onclick="">Deny</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

<script>
</script>

<script src="/scripts/agent_panel.js"></script>

<%- include("footer"); %>